<!DOCTYPE HTML>
<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title></title>
		<meta name="keywords" content="" />
		<meta name="description" content="" />
		<meta name="generator" content="" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
		<link href="css/haiersoft.css" rel="stylesheet" type="text/css" media="screen,print" />
		<link href="css/print.css" rel="stylesheet" type="text/css" media="print" />
		<script src="js/jquery-1.10.1.min.js"></script>
		<script src="js/side.js" type="text/javascript"></script>
		<script src="js/jquery.cookie.js"></script>
		<script src="src/lib/ajax.js"></script>
		<script src="src/lib/util.js"></script>
		<script src="js/config/configure.js"></script>
		<script src="src/lib/checkLogin.js"></script>

		<!-- 文件上传 相关-->
		<link href="fileUpload/css/bootstrap.min.css" rel="stylesheet">
		<link href="fileUpload/css/fileinput.css" media="all" rel="stylesheet" type="text/css" />
		<link href="fileUpload/css/font-awesome.min.css" media="all" rel="stylesheet" type="text/css" />
		<link href="fileUpload/themes/explorer-fa/theme.css" media="all" rel="stylesheet" type="text/css" />
		<script src="fileUpload/js/plugins/sortable.js" type="text/javascript"></script>
		<script src="fileUpload/js/fileinput.js" type="text/javascript"></script>
		<script src="fileUpload/js/locales/fr.js" type="text/javascript"></script>
		<script src="fileUpload/js/locales/es.js" type="text/javascript"></script>
		<script src="fileUpload/themes/explorer-fa/theme.js" type="text/javascript"></script>
		<script src="fileUpload/themes/fa/theme.js" type="text/javascript"></script>
		<script src="fileUpload/js/popper.min.js" type="text/javascript"></script>
		<script src="fileUpload/js/bootstrap.min.js" type="text/javascript"></script>
	</head>

	<body>
		<!-- Popup -->
		<div id="Popup">

			<!-- SubPopup -->
			<div id="SubPopup">
				<script type="text/javascript">
					$(function() {
						$(".select").each(function() {
							var s = $(this);
							var z = parseInt(s.css("z-index"));
							var dt = $(this).children("dt");
							var dd = $(this).children("dd");
							var _show = function() {
								dd.slideDown(200);
								dt.addClass("cur");
								s.css("z-index", z + 1);
							};
							var _hide = function() {
								dd.slideUp(200);
								dt.removeClass("cur");
								s.css("z-index", z);
							};
							dt.click(function() {
								dd.is(":hidden") ? _show() : _hide();
							});
							dd.find("a").click(function() {
								dt.html($(this).html());
								_hide();
							});
							$("body").click(function(i) {
								!$(i.target).parents(".select").first().is(s) ? _hide() : "";
							});
						})
					})
				</script>
				<div class="form_boxC">
					<div>
						<font color="red">*</font>更新会根据配置进行更新</div>
					<table cellpadding="0" cellspacing="0">
						<tr>
							<th width="100">服务器地址</th>
							<td>
								<div class="txtbox floatL" style="width:110px;" id="ip_box">

								</div>
							</td>
						</tr>
						<tr>
							<th width="100">服务器状态</th>
							<td>
								<div class="txtbox floatL" style="width:50px;" id="status_box">

								</div>
							</td>
						</tr>
						<tr>
							<th>上次更新时间</th>
							<td>
								<div class="txtbox floatL" style="width:147px;" id="lastUpdateTime_box">

								</div>
							</td>
						</tr>
						<tr>
							<th>更新配置表</th>
						</tr>
					</table>
					<div style="width: 820px;">
						<form enctype="multipart/form-data">
							<div class="file-loading">
								<input id="kv-explorer" type="file" multiple>
							</div>
						</form>
					</div>
					<script>
					</script>
				</div>
			</div>
			<input type="hidden" name="keyID" id="keyID_box" value="" />
			<div class="btn_box floatL" style="margin-left: 40px;">
				<input name="" type="button" value="启动服务器" onmousemove="this.className='input_move'" onmouseout="this.className='input_out'">
			</div>
			<div class="btn_boxB floatL mag_l20">
				<input name="" type="button" value="关闭服务器" onclick="stopServer()" onmousemove="this.className='input_move'" onmouseout="this.className='input_out'">
			</div>
		</div>
		</div>
		<script type="text/javascript">
			var baseUrl = document.URL;
			var queryStr = baseUrl.split("?")[1];
			var keyID = queryStr.split("=")[1];
			$(function() {
				var getServerUrl = port + "/editServer?params={keyID:" + keyID + "}";
				$("#keyID_box").val(keyID)
				$.getJSON(getServerUrl, function(data) {
					console.log(data)
					if(data.code == 0) {
						if(data.json.status == 0) {
							$("#status_box").append('<font color="green" size="3" id="status_val">开启</font>');
						} else if(data.json.status == 1) {
							$("#status_box").append('<font color="red" size="3" id="status_val">关闭</font>');
						}
						$("#ip_box").append('<font size="3">' + data.json.ip + '</font>');
						$("#lastUpdateTime_box").append('<font size="3">' + data.json.lastUpdateTime + '</font>');
					}
				})
			})

			function stopServer() {
				var id = $("#keyID_box").val();
				var stopUrl = port + "/stopServer?params={keyID=" + id + "}";
				$.getJSON(stopUrl, function(data) {
					if(data.code == 0) {
						// 成功关闭
					}
					alert(data.json);
				})
			}

			$("#kv-explorer").fileinput({
				'theme': 'fa',
				'uploadUrl': port + '/uploadExcels?params={keyID:' + keyID +"}",
				showClose: false,
				overwriteInitial: false,
				allowedFileExtensions: ['xlsx', 'xls']
			});
		</script>
	</body>

</html>