<!DOCTYPE HTML>
<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title></title>
		<meta name="keywords" content="" />
		<meta name="description" content="" />
		<meta name="generator" content="" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<link href="css/haiersoft.css" rel="stylesheet" type="text/css" media="screen,print" />
		<link href="css/print.css" rel="stylesheet" type="text/css" media="print" />
		<script src="js/jquery-1.10.1.min.js"></script>
		<script src="js/side.js" type="text/javascript"></script>
		<script src="js/jquery.cookie.js"></script>
		<script src="src/lib/ajax.js"></script>
		<script src="src/lib/util.js"></script>
		<script src="js/config/configure.js"></script>
		<!--<script src="src/lib/checkLogin.js"></script>-->

		<!-- 文件上传 相关-->
		<link href="fileUpload/css/bootstrap.min.css" rel="stylesheet">
		<link href="fileUpload/css/fileinput.css" media="all" rel="stylesheet" type="text/css" />
		<link href="fileUpload/css/font-awesome.min.css" media="all" rel="stylesheet" type="text/css" />
		<link href="fileUpload/themes/explorer-fa/theme.css" media="all" rel="stylesheet" type="text/css" />
		<script src="fileUpload/js/plugins/sortable.js" type="text/javascript"></script>
		<script src="fileUpload/js/fileinput.js" type="text/javascript"></script>
		<script src="fileUpload/js/locales/fr.js" type="text/javascript"></script>
		<script src="fileUpload/js/locales/es.js" type="text/javascript"></script>
		<script type="text/javascript" src="fileUpload/js/locales/zh.js"></script>
		<script src="fileUpload/themes/explorer-fa/theme.js" type="text/javascript"></script>
		<script src="fileUpload/themes/fa/theme.js" type="text/javascript"></script>
		<script src="fileUpload/js/popper.min.js" type="text/javascript"></script>
		<script src="fileUpload/js/bootstrap.min.js" type="text/javascript"></script>
	</head>

	<body>
		<!-- Popup -->
		<div id="Popup">
			<!-- SubPopup -->
			<div id="SubPopup">
				<script type="text/javascript">
					$(function() {
						$(".select").each(function() {
							var s = $(this);
							var z = parseInt(s.css("z-index"));
							var dt = $(this).children("dt");
							var dd = $(this).children("dd");
							var _show = function() {
								dd.slideDown(200);
								dt.addClass("cur");
								s.css("z-index", z + 1);
							};
							var _hide = function() {
								dd.slideUp(200);
								dt.removeClass("cur");
								s.css("z-index", z);
							};
							dt.click(function() {
								dd.is(":hidden") ? _show() : _hide();
							});
							dd.find("a").click(function() {
								dt.html($(this).html());
								_hide();
							});
							$("body").click(function(i) {
								!$(i.target).parents(".select").first().is(s) ? _hide() : "";
							});
						})
					})
				</script>
				<h3>更新服务器资源：</h3><br/>
				已选服务器：
				<div style="width: 1200px;">
					<table class="table table-bordered">
						<thead>
							<tr>
								<th>服务器ID</th>
								<th>服务器名</th>
								<th>ip地址</th>
								<th>服务器路径</th>
								<th>网关路径</th>
								<th>上次更新时间</th>
								<th>服务器状态</th>
							</tr>
						</thead>
						<tbody id="datagrid">
						</tbody>
					</table>
				</div>
				<div style="width: 1200px;">
					<form enctype="multipart/form-data">
					<div><font color="red">***上传游戏服***</font></div>
						<div class="file-loading">
							<input id="kv-explorer-game" type="file" multiple>
						</div>
						</br>
						<div><font color="red">****上传网关服(只针对游戏服类型)***</font></div>
						<div class="file-loading">
							<input id="kv-explorer-gate" type="file" multiple>
						</div>
					</form>
				</div>
				<div><font color="red">*</font>一键上传,仅支持上传 zip 格式&nbsp;&nbsp;&nbsp;&nbsp;若服务器未关闭,上传操作将会关闭服务器</div>

				<div class="btn_box floatL" style="margin-top: 10px;">
					<input onclick="backHome()" type="button" value="返回服务器列表" onmousemove="this.className='input_move'" onmouseout="this.className='input_out'">
				</div>
			</div>
		</div>

		<script type="text/javascript">
			var baseUrl = document.URL;
			console.log(baseUrl);
			var queryStr = baseUrl.split("?")[1];
			var keyIDs = queryStr.split("=")[1];
			var type = $("#selectBox_type").val();

			$(function() {
				var getServersUrl = port + "/getServers?params={keyIDs:'" + keyIDs  + "'}";
				$.getJSON(getServersUrl, function(data) {
					if(data.code == 0) {
						var st = "";
						$.each(data.json, function(key, value) {
							if(value.status == 0) {
								st = "<font color='green'>开启</font>";
							} else {
								st = "<font color='red'>关闭</font>";
							}
							$("#datagrid").append("<tr><td>" + value.serverID +
								"</td><td>" + value.serverName +
								"</td><td>" + value.serverIp +
								"</td><td>" + value.serverAddress +
								"</td><td>" + value.gateAddress +
								"</td><td>" + value.lastUpdateTime +
								"</td><td>" + st +
								"</td></tr>"
							);
						})
					}
				})
			})
			
			$("#selectBox_type").change(function(){
		    	type = $("#selectBox_type").val();
		    });

			function backHome() {
				location.href = "main.html";
			}
		</script>

		<script type="text/javascript">
			$("#kv-explorer-game").fileinput({
				'theme': 'fa',
				'uploadUrl': port + '/uploadServer?params={keyIDs:"' + keyIDs +'",type:'+ 1 + '}',
				showClose: false,
				overwriteInitial: false,
				allowedFileExtensions: ['zip'],
				previewFileIconSettings: {
					'xlsx': '<i class="fa fa-file-excel-o text-success"></i>',
                	'xls': '<i class="fa fa-file-excel-o text-success"></i>',
                	'zip': '<i class="fa fa-file-archive-o text-muted"></i>',
                }
			});
			$("#kv-explorer-gate").fileinput({
				'theme': 'fa',
				'uploadUrl': port + '/uploadServer?params={keyIDs:"' + keyIDs +'",type:'+ 2 + '}',
				showClose: false,
				overwriteInitial: false,
				allowedFileExtensions: ['zip'],
				previewFileIconSettings: {
					'xlsx': '<i class="fa fa-file-excel-o text-success"></i>',
                	'xls': '<i class="fa fa-file-excel-o text-success"></i>',
                	'zip': '<i class="fa fa-file-archive-o text-muted"></i>',
                }
			});
		</script>
	</body>

</html>